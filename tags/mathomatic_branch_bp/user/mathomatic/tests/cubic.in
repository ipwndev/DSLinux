clear all
; The book says this is the general cubic equation,
; but I have found it doesn't work unless there is exactly one
; real root and 2 complex roots.

; Solutions for (x) in the cubic equation:
0 = x^3 + a1x^2 + a2x + a3

q=(3a2-a1^2)/9
r=(9a1*a2-27a3-2a1^3)/54
s=(r+(q^3+r^2)^.5)^(1/3)
t=(r-(q^3+r^2)^.5)^(1/3)
x1=s+t-a1/3
elim s t q r
x2=-(s+t)/2-a1/3+sign*i#*3^.5*(s-t)/2
elim s t q r
clear 2-5
; x1 = the real root
; x2 = the 2 complex roots

; The optimize command works well with these equations.
; Try "optimize all".
