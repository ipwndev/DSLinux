<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <style type="text/css" media="screen,projection"><!--
    @import url("../www/magick.css");
  //--></style>
  <meta name="verify-v1" content="g222frIIxcQTrvDR3NBRUSKP3AnMNoqxOkIniCEkV7U=" />
  <link rel="meta" type="application/rdf+xml" title="ICI" href="http://imagemagick.org/ici.rdf" />
  <title>ImageMagick: Install the ImageMagickObject COM+ Component</title>
  <meta http-equiv="Content-Language" content="en-US"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta http-equiv="Reply-to" content="magick-users@imagemagick.org"/>
  <meta name="Generator" content="PHP"/>
  <meta name="Keywords" content="install, the, imagemagickobject, com+, component, ImageMagick, ImageMagic, MagickCore, MagickWand, PerlMagick, Magick++, RMagick, PythonMagick, JMagick, TclMagick, Image, Magick, Magic, Wand, ImageMagickObject"/>
  <meta name="Description" content="ImageMagick® is a software suite to create, edit, and compose bitmap images. It can read, convert and write images in a variety of formats (about 100) including GIF, JPEG, JPEG-2000, PNG, PDF, PhotoCD, TIFF, and DPX. Use ImageMagick to translate, flip, mirror, rotate, scale, shear and transform images, adjust image colors, apply various special effects, or draw text, lines, polygons, ellipses and Bézier curves.  ImageMagick is free software delivered as a ready-to-run binary distribution or as source code that you can freely use, copy, modify, and distribute. Its license is compatible with the GPL. It runs on all major operating systems.  The functionality of ImageMagick is typically utilized from the command line or you can use the features from programs written in your favorite programming language. Choose from these interfaces: MagickCore (C), MagickWand (C), ChMagick (Ch), Magick++ (C++), JMagick (Java), L-Magick (Lisp), PascalMagick (Pascal), PerlMagick (Perl), MagickWand for PHP (PHP), PythonMagick (Python), RMagick (Ruby), or TclMagick (Tcl/TK). With a language interface, use ImageMagick to modify or create images automagically and dynamically."/>
  <meta name="Rating" content="GENERAL"/>
  <meta name="Robots" content="INDEX, FOLLOW"/>
  <meta name="Generator" content="ImageMagick Studio LLC"/>
  <meta name="Author" content="ImageMagick Studio LLC"/>
  <meta name="Revisit-after" content="2 DAYS"/>
  <meta name="Resource-type" content="document"/>
  <meta name="Copyright" content="Copyright (c) 1999-2008 ImageMagick Studio LLC"/>
  <meta name="Distribution" content="Global"/>
  <link rel="shortcut icon" href="../images/wand.ico"  type="images/vnd.microsoft.icon"/>
</head>

<body id="www-imagemagick-org">
  <table id="titlebar" style="width: 100%;background-color: #f5f5f5" cellpadding="0" cellspacing="0" border="0" summary="ImageMagick">
    <tbody>
      <tr valign="top">
        <td align="left"><a href="../index.html"><img id="titlebar-west" src="../images/script.png" alt="[ImageMagick]" width="350" height="60" vspace="28" name="titlebar-west"/></a></td>
        <td align="left"><a href="https://secure.networkredux.com/affiliate/idevaffiliate.html?id=146" target="1395037553"><img id="titlebar-west" src="../images/networkredux.png" alt="[sponsor]" border="0" vspace="45" name="titlebar-west"/></a></td>
        <td width="99%"><br /> </td>
        <td style="background-color: white" align="right"><a href="../index.html"><img src="../images/sprite.jpg" alt="" width="114" height="118" border="0" name="titlebar-east"/></a></td>
        <td style="background-color: white" align="right"><a href="http://www.imagemagick.org/discourse-server/" target="459910896"><img id="titlebar-east" src="../images/logo.jpg" alt="" width="114" height="118" border="0" name="titlebar-east"/></a></td>
      </tr>
    </tbody>
  </table>

  <table style="width: 100%" border="0" cellpadding="0" cellspacing="0" summary="">
  <tbody>

    <tr valign="top" style="height: 100%;">
      <td id="menu" width="1%" height="100%">
      <p><a href="#main">Skip to page contents</a></p>
      <font size="-1">
      <span>[</span>
      <a href="../index.html">About ImageMagick</a>
  <span>]</span><br /><span>[</span>
      <a href="../www/command-line-tools.html">Command-line Tools</a>
      <a href="../www/command-line-processing.html" class="sub">Processing</a>
      <a href="../www/command-line-options.html" class="sub">Options</a>
      <a href="http://www.imagemagick.org/Usage/" target="1863634014" class="sub">Usage</a>
      <a href="../www/api.html">Program Interfaces</a>
      <a href="../www/magick-wand.html" class="sub">MagickWand</a>
      <a href="../www/magick-core.html" class="sub">MagickCore</a>
      <a href="../www/perl-magick.html" class="sub">PerlMagick</a>
      <a href="../www/Magick++/" target="1883857877" class="sub">Magick++</a>
      <a href="../www/architecture.html">Architecture</a>
  <span>]</span><br /><span>[</span>
      <a href="../www/install-source.html">Install from Source</a>
      <a href="../www/install-source.html#unix" class="sub">Unix</a>
      <a href="../www/install-source.html#windows" class="sub">Windows</a>
      <a href="../www/binary-releases.html">Binary Releases</a>
      <a href="../www/binary-releases.html#unix" class="sub">Unix</a>
      <a href="../www/binary-releases.html#macosx" class="sub">Mac OS X</a>
      <a href="../www/binary-releases.html#windows" class="sub">Windows</a>
      <a href="../www/resources.html">Resources</a>
  <span>]</span><br /><span>[</span>
      <a href="../www/download.html">Download</a>
  <span>]</span><br /><span>[</span>
      <a href="../www/sitemap.html">Site Map</a>
			<a href="../www/links.html" class="sub">Links</a>
  <span>]</span><br /><span>[</span>
      <a href="../www/sponsors.html">Sponsors:</a>
      <fieldset>
  <a href="http://www.goin2travel.com" class="sponsor" target="sponsor">Vacation Rentals<br />by Owner</a><!-- 200902010250 -->
      <br />
      <a href="http://www.brothersoft.com" class="sponsor" target="sponsor">Software Download</a><!-- 200809010200 -->
      <br />
      <a href="http://www.iceposter.com" class="sponsor" target="sponsor">Posters</a><!-- 200812010200 -->
      <br />
      <a href="http://www.hotel-erb.de"><img src="../images/bw_erb.gif" alt="[Munich Hotel]" width="110" height="40" border="0" name="Munich Hotel"/></a> <!-- 200809010160 -->
      <br />
      <a href="http://www.kmvu.org"><img src="../images/button_kmvu.jpg" alt="[Visually United]" width="110" height="40" border="0" name="kmvu"/></a> <!-- 200808010160 -->
      <br />
      <a href="http://www.ivedc.org"><img src="../images/ivedc.png" alt="[Interactive Video Entertainment Development Centre]" width="105" height="60" border="0" name="ivedc"/></a> <!-- 200808030160 -->
      <br />
      <a href="http://www.imade-art.de"><img src="../images/imade_art2.jpg" alt="[Kunst bei imade-art]" width="116" height="28" border="0" name="Kunst bei imade-art"/></a> <!-- 200811010160 -->
      <br />
      <a href="http://business-directory.com"><img src="../images/business+directory.gif" alt="[Business + Directory]" width="105" height="60" border="0" name="business+directory"/></a> <!-- 200808010160 -->
      </fieldset>
      <span>]</span>
      </font>
      </td>

      <td id="main" valign="top">
<p class="navigation-index">[<a href="../www/#intro">Introduction to the ImageMagick COM+ Object</a> &bull; <a href="../www/#build">Build ImageMagickObject From Source</a>]</p>

<div style="margin: auto;">
  <h2><a name="intro"></a>Introduction to the ImageMagick COM+ Object</h2>
</div>

<p>The ImageMagickObject is a COM+ compatible component that can be invoked from any language capable of using COM objects.  The intended use is for Windows Scripting Host VBS scripts and Visual Basic, but it is also available from to C++, ASP, and other languages like Delphi, Perl and PHP.</p>

<p>The ImageMagickObject COM+ component provides access to the <a href="../www/compare.html">compare</a>, <a href="../www/convert.html">convert</a>, <a href="../www/composite.html">composite</a>, <a href="../www/mogrify.html">mogrify</a>, <a href="../www/identify.html">identify</a>, <a href="../www/montage.html">montage</a>, and <a href="../www/stream.html">stream</a> tools, efficiently executing them as part of your process, rather than as external programs. The way you use it is exactly the same. You pass it a list of strings including filenames and various options and it does the job. In fact, you can take any existing batch scripts that use the command line tools and translate them into the equivalent calls to the COM+ object in a matter of minutes. Beyond that, there is also a way to pass in and retrieve images in memory in the form of standard smart arrays (byte arrays). Samples are provided, to show both the simple and more elaborate forms of access.</p>

<p>ImageMagick provides a statically-built ImageMagick object as part of its <a href="../www/binary-releases.html#windows">Windows installation package</a>.  When this package is installed, ImageMagickObject and its sample programs are installed as well.</p>

<pre class="text">
  c:\Program Files\ImageMagick-6.?-?-Q16\ImageMagickObject
</pre>

<p>by default (path shown is for the Q:16 build). ImageMagickObject is registered if the checkbox, <kbd>Register ImageMagickObject</kbd>, is checked at install time.</p>

<p>To execute the sample program from the Windows Command Shell, type:</p>

<pre class="text">
  cscript SimpleTest.vbs
</pre>

<p>Since the ImageMagick utility command line parsers are incorporated within ImageMagickObject, please refer to the <a href="../www/command-line-tools.html">command-line tools</a> discussion to learn how to use it. The sample VBS scripts show how the object should be called and used and have lots of comments.</p>

<p>For C++ programmers - have a look at the <kbd>MagickCMD.cpp</kbd> command line utility for an example of how to call the object from C++.  The object requires a variable size list of BSTR's to emulate the command line argc, argv style calling conventions of the COM component which is more complex in C++ then in VBS or VB.</p>

<p>MagickCMD is a C++ sample, but it also serves as a replacement for all the other command line utilities in most applications. Instead of using <kbd>convert xxxx yyyy</kbd> you can use <kbd>MagickCMD convert xxxx yyyy</kbd> instead. MagickCMD calls the COM object to get accomplish the designated task.  This small tight combination replaces the entire usual binary distribution in just a few megabytes.</p>

<div style="margin: auto;">
  <h2><a name="build"></a>Build ImageMagickObject From Source</h2>
</div>

<p>The source code for ImageMagickObject is available from the ImageMagick <a href="../www/subversion.html">subversion</a> repository, or as part of the <a href="../www/install-source.html#windows">Windows source</a> distribution. Once the source code has been retrieved and extracted, the source for ImageMagickObject is the directory <kbd>ImageMagick\contrib\win32\ATL7ImageMagickObject</kbd>, however, ImageMagick itself must be built using the static-multithread (VisualStaticMT) build configuration.  Building ImageMagickObject requires Microsoft Visual C++ 7.0 as delivered with Microsoft's Visual Studio .NET package. See the <a href="../www/install-source.html#windows">Windows compilation instructions</a> to get ImageMagick itself built before building the ImageMagick COM+ component.</p>

<p>Once the VisualStaticMT project has been built, build the ImageMagickObject with this procedure:</p>

<pre class="text">
  cd  ImageMagick\contrib\win32\ATL7ImageMagickObject
  BuildImageMagickObject release
</pre>

<p>Here, we assume that the VisualStaticMT project has been built using the release setting for an optimized build. If the debug setting was used for a debug build, specify the argument <kbd>debug</kbd>; instead.</p>

<p>To register the DLL as a COM+ server, type</p>

<pre class="text">
  regsvr32 /c /s ImageMagickObject.dll
</pre>

<p>To unregister the DLL, type</p>

<pre class="text">
  regsvr32 /u /s ImageMagickObject.dll
</pre>

<p>Use MagickCMD to exercise ImageMagickObject to verify that it is working properly.</p>
      </td>
      <td id="margin" width="1%" height="100%" valign="top" align="right">&nbsp;</td>
    </tr>
  </tbody>
  </table>
  <div id="linkbar">
    <span id="linkbar-west">
      <font size="-1">
      <a href="http://www.downloadroute.com/" target="1578171690">Downloads and Opinions</a><!-- 200809010100 -->
      </font>
    </span>
    <span id="linkbar-east">
      <font size="-1">
      <a href="http://www.online-kredit-index.de/" target="489438467">Kredit</a><!-- 200808010100 -->
      </font>
    </span>
    <span id="linkbar-center">
      <a href="http://www.imagemagick.org/discourse-server/" target="1192391554">Discourse Server</a> &bull;
      <a href="../www/mailing-list.html">Mailing Lists</a> &bull;
      <a href="http://cafe.imagemagick.org" target="40346620">Cafe</a> &bull;
    <a href="http://www.imagemagick.org/MagickStudio/scripts/MagickStudio.cgi" target="161481786">Studio</a>
    </span>
  </div>
  <div id="footer">
    <span id="footer-west">&copy; 1999-2008 ImageMagick Studio LLC</span>
  </div>
  <div style="clear: both; margin: 0; width: 100%; "></div>
</body>
</html>
